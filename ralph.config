# Ralph Configuration for OpenCode

# Agent command to use (default: opencode)
AGENT_CMD="opencode run"

# OpenCode server mode (faster for repeated calls)
# Uncomment and configure if running opencode serve
# AGENT_CMD="opencode run --attach http://localhost:4096"

# Model selection (leave empty for default)
# MODEL="claude-sonnet-4-20250514"

# Completion promise text
COMPLETION_PROMISE="COMPLETE"

# Maximum iterations before stopping
MAX_ITERATIONS=100

# Stale story timeout (seconds) - for automatic recovery
STALE_SECONDS=3600

# Working directory
RALPH_DIR="${RALPH_DIR:-$HOME/projects/.ralph}"

# Verbose output
VERBOSE="false"

# ============================================================
# SWARM CONTAINMENT SETTINGS
# These settings prevent runaway swarm agents from exhausting
# system resources. Adjust based on your system's capabilities.
# ============================================================

# Maximum workers per swarm run (default: 8)
# This is the maximum number of parallel workers that can be
# spawned in a single swarm run. Setting this too high can
# cause system resource exhaustion.
SWARM_MAX_WORKERS=8

# Delay between spawning workers in seconds (default: 1)
# This adds a delay between each worker spawn to prevent
# sudden resource spikes. Set to 0 for immediate spawning
# (not recommended for production).
SWARM_SPAWN_DELAY=1

# Maximum total concurrent workers system-wide (default: 16)
# This limits the total number of workers across ALL swarm runs.
# New runs will be rejected if this limit is exceeded.
SWARM_MAX_TOTAL_WORKERS=16

# Maximum child processes per worker (default: 50)
# Limits the number of child processes each worker can spawn.
# Prevents fork bombs and runaway process trees.
SWARM_MAX_PROCESSES_PER_WORKER=50

# Memory limit per worker in MB (default: 1024)
# Limits memory usage for each worker process. Workers exceeding
# this limit will be terminated. Set to 0 for no limit.
SWARM_MAX_MEMORY_MB=1024

# CPU time limit per worker in seconds (default: 3600)
# Limits total CPU time per worker. Workers exceeding this limit
# will be terminated. Set to 0 for no limit.
SWARM_MAX_CPU_SECONDS=3600

# Enable sandboxing for workers (experimental)
# When true, workers run in restricted environment with limited
# filesystem access and no network. Requires Linux namespaces.
# SWARM_ENABLE_SANDBOX=false